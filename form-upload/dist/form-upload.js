define("value/form-upload/1.0.0/form-upload",["$","value/upload/1.0.0/upload","value/form/1.0.0/form-widget","value/base/1.0.0/base","arale/templatable/0.9.2/templatable","gallery/handlebars/1.0.2/handlebars","arale/widget/1.1.1/widget","arale/base/1.1.1/base","arale/class/1.1.0/class","arale/events/1.1.0/events","./upload.handlebars"],function(a){"use strict";var b=a("$");a("value/upload/1.0.0/upload");var c=a("value/form/1.0.0/form-widget"),d=a("./upload.handlebars"),e=c.extend({attrs:{template:d,model:{},value:{},colWidth:10,url:"",allowFileTypes:[]},fileInfo:{},initAttrs:function(a,b){e.superclass.initAttrs.call(this,a,b);var c=this.get("model");c.btnId="file_btn_"+ +new Date},setup:function(){e.superclass.setup.call(this),this.bindAjaxUpload();var a=this.get("value");if(a.fileName){this.fileInfo=a;var b=a.fileName;this.$(".sco-doc-title").text(b||"未选择内容")}},bindAjaxUpload:function(){var a=this,c=this.get("url"),d={fieldName:"myfile",otherParams:{},fileType:{allow:a.get("allowFileTypes")},formAction:c,onFileTypeFail:function(a,c){b.message("文件类型必须是"+c.allow.join(","),"danger")},onSubmit:function(a){return a.attr("data-old-text",a.text()),a.text("上传中..."),!0},onComplete:function(b,c){var d=c.data.model;b.text(b.attr("data-old-text"));var e=d.fileName;a.$(".sco-doc-title").text(e),a.fileInfo=d}};this.$(".doc-choice").ajaxUpload(d)},getValue:function(){var a=this.fileInfo.fileName,b=this.fileInfo.fileSize,c=this.fileInfo.fileType,d=this.fileInfo.encodeFile,e=this.fileInfo.filePath;return{fileName:a,fileType:c,fileSize:b,encodeFile:d,filePath:e}}});return e}),define("value/form-upload/1.0.0/upload.handlebars",["gallery/handlebars/1.0.2/runtime"],function(a,b,c){var d=a("gallery/handlebars/1.0.2/runtime"),e=d.template;c.exports=e(function(a,b,c,d,e){this.compilerInfo=[3,">= 1.0.0-rc.4"],c=c||{};for(var f in a.helpers)c[f]=c[f]||a.helpers[f];e=e||{};var g,h,i="",j="function",k=this.escapeExpression;return i+='<div class="form-group">\n    <label class="col-xs-2 control-label '+k((g=b.label,g=null==g||g===!1?g:g.requiredCls,typeof g===j?g.apply(b):g))+'">'+k((g=b.label,g=null==g||g===!1?g:g.text,typeof g===j?g.apply(b):g))+'</label>\n    <div class="col-xs-10">\n        <label for="',(h=c.btnId)?h=h.call(b,{hash:{},data:e}):(h=b.btnId,h=typeof h===j?h.apply(b):h),i+=k(h)+'" class="btn btn-default doc-choice">选择文件</label>\n        <span class="sco-doc-title">未选择内容</span>\n    </div>\n</div>'})});
