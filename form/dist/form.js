define("value/form/1.0.0/form",["$","jquery/validator/1.11.1/validator-bootstrap3","value/base/1.0.0/base","arale/templatable/0.9.2/templatable","gallery/handlebars/1.0.2/handlebars","arale/widget/1.1.1/widget","arale/base/1.1.1/base","arale/class/1.1.0/class","arale/events/1.1.0/events"],function(a){"use strict";var b=a("$");a("jquery/validator/1.11.1/validator-bootstrap3");var c=a("value/base/1.0.0/base"),d="form-vertical",e=c.extend({element:"<form></form>",attrs:{className:"form-horizontal",parentNode:null,submitHandler:null,verticalLayout:!1,widgets:[]},formWidgets:null,setup:function(){this._parseWidgets(),this.setClassName(),e.superclass.setup.call(this)},setClassName:function(){var a=this.get("verticalLayout");a&&this.set("className",d)},_parseWidgets:function(){var a=this,c={},d=this.element,e={},f={},g=this.get("widgets");g.forEach(function(g){d.append(g.element);var h=g.get("name"),i=g.get("commonValid");if(i){var j=g.getRules(),k=g.getMessages();b.isEmptyObject(j)||(e[h]=j),b.isEmptyObject(k)||(f[h]=g.getMessages())}c[h]=g,g.set("form",a)});var h={rules:e,messages:f,submitHandler:function(){}};this.element.validate(h),this.formWidgets=c},registerWidget:function(a){var b=a.get("name");this.formWidgets[b]=a},getWidget:function(a){return this.formWidgets[a]},getFormData:function(){var a={},c=this.formWidgets;return Object.keys(c).forEach(function(d){b.extend(a,c[d].getValue())}),a},clear:function(){var a=this.formWidgets;Object.keys(a).forEach(function(b){a[b].clear()})},submit:function(){var a=!0,b=this.formWidgets;if(Object.keys(b).forEach(function(c){b[c].valid()||(a=!1)}),a){var c=this.get("submitHandler");c.call(this,this.element)}},destroy:function(){var a=this.formWidgets;Object.keys(a).forEach(function(b){a[b].destroy()}),e.superclass.destroy.call(this)}});return e});
